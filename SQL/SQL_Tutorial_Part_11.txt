SQL Aggregate Functions -

An aggregate function is a function that performs a calculation on a set of values, and returns a single value.

Aggregate functions are often used with the /GROUP BY/ clause of the /SELECT/ statement.
The /GROUP BY/ clause splits the result-set into groups of values and the aggregate function can be used to return a 
single value for each group.

The most commonly used SQL aggregate functions are:
    * MIN() - returns the smallest value within the selected column
    * MAX() - returns the largest value within the selected column
    * COUNT() - returns the number of rows in a set
    * SUM() - returns the total sum of a numerical column
    * AVG() - returns the average value of a numerical column

Aggregate functions ignore null values (except for COUNT(*)).



SQL MIN() and MAX() Functions -

The /MIN()/ function returns the smallest value of the selected column.
The /MAX()/ function returns the largest value of the selected column.

    Example - Find the lowest price in the Price column:
        SELECT MIN(Price)
        FROM Products;

    Example - Find the highest price in the Price column:
        SELECT MAX(Price)
        FROM Products;

""" Syntax """
SELECT MIN(column_name)
FROM table_name
WHERE condition;

--------------------------

SELECT MAX(column_name)
FROM table_name
WHERE condition;



""" Set Column Name (Alias) """
When you use MIN() or MAX(), the returned column will not have a descriptive name. 
To give the column a descriptive name, use the AS keyword:
    Example:
        SELECT MIN(Price) AS smallestPrice
        FROM Products;


""" Use MIN() with GROUP BY """
Here we use the /MIN()/ function and the /GROUP BY/ clause, to return the smallest price for each 
category in the Products table:
    Example:
        SELECT MIN(Price) AS SmallestPrice, CategoryID
        FROM Products
        GROUP BY CategoryID;



SQL GROUP BY Statement -

The /GROUP BY/ statement groups rows that have the same values into summary rows, like "find the number of customers 
in each country".

The /GROUP BY/ statement is often used with aggregate functions (COUNT(), MAX(), MIN(), SUM(), AVG()) to group the 
result-set by one or more columns.

""" GROUP By Syntax """
SELECT column_name(s)
FROM table_name
WHERE condition
GROUP BY column_name(s)
ORDER BY column_name(s);


""" SQL GROUP BY Examples """
The following SQL statement lists the number of customers in each country:

Example:
    SELECT COUNT(CustomerID), Country
    FROM Customers
    GROUP BY Country;


The following SQL statement lists the number of customers in each country, sorted high to low:
    Example:
        SELECT COUNT(CustomerID), Country
        FROM Customers
        GROUP BY Country
        ORDER BY COUNT(CustomerID) DESC;



SQL COUNT() Function -
The COUNT() function returns the number of rows that matches a specified criterion.

    Example - Find the total number of rows in the Products table:
        SELECT COUNT(*)
        FROM Products;

""" Syntax """
SELECT COUNT(column_name)
FROM table_name
WHERE condition;


""" Specify Column """
You can specify a column name instead of the asterix symbol (*).

If you specify a column name instead of (*), NULL values will not be counted.

    Example - Find the number of products where the ProductName is not null:
        SELECT COUNT(ProductName)
        FROM Products;

""" Add a WHERE Clause """
You can add a /WHERE/ clause to specify conditions:
    Example - Find the number of products where Price is higher than 20:
        SELECT COUNT(ProductID)
        FROM Products
        WHERE Price > 20;


""" Ignore Duplicates """
You can ignore duplicates by using the /DISTINCT/ keyword in the COUNT() function.
If /DISTINCT/ is specified, rows with the same value for the specified column will be counted as one.
    
    Example - How many different prices are there in the Products table:
        SELECT COUNT(DISTINCT Price)
        FROM Products;


""" Use an Alias """
Give the counted column a name by using the /AS/ keyword.

    Example - Name the column "Number of records":
        SELECT COUNT(*) AS [Number of records]
        FROM Products;


""" Use COUNT() with GROUP BY """
Here we use the /COUNT()/ function and the /GROUP BY/ clause, to return the number of records for each 
category in the Products table:
    Example:
        SELECT COUNT(*) AS [Number of records], CategoryID
        FROM Products
        GROUP BY CategoryID;

Point: If you you need to write something that need space, you need to put that in [] to recognize it as a unit element.



SQL SUM() Function -
The SUM() function returns the total sum of a numeric column.

    Example - Return the sum of all Quantity fields in the OrderDetails table:
        SELECT SUM(Quantity)
        FROM OrderDetails;


""" Syntax """
SELECT SUM(column_name)
FROM table_name
WHERE condition;


""" Add a WHERE Clause """
You can add a /WHERE/ clause to specify conditions:
    Example - Return the sum of the Quantity field for the product with ProductID 11:
        SELECT SUM(Quantity)
        FROM OrderDetails
        WHERE ProductID = 11;


""" Use an Alias """
Give the summarized column a name by using the /AS/ keyword.
    Example - Name the column "total":
        SELECT SUM(Quantity) AS total
        FROM OrderDetails;


""" Use SUM() with GROUP BY """
Here we use the /SUM()/ function and the /GROUP BY/ clause, to return the Quantity for each OrderID in the 
OrderDetails table:
    Example:
        SELECT orderID, SUM(Quantity) AS [Total Quantity]
        FROM OrderDetails
        GROUP BY OrderID;


""" SUM() with an Expression """
The parameter inside the SUM() function can also be an expression.

If we assume that each product in the OrderDetails column costs 10 dollars, we can find the total earnings in dollars 
by multiply each quantity with 10:

    Example - Use an expression inside the SUM() function:
        SELECT SUM(Quantity * 10)
        FROM OrderDetails;

We can also join the OrderDetails table to the Products table to find the actual amount, instead of assuming 
it is 10 dollars:
    Example - Join OrderDetails with Products, and use SUM() to find the total amount:
        SELECT SUM(Price * Quantity)
        FROM OrderDetails
        LEFT JOIN Products ON OrderDetails.ProductID = Products.ProductID;


""" SQL Joins """
A /JOIN/ clause is used to combine rows from two or more tables, based on a related column between them.

Notice that the "CustomerID" column in the "Orders" table refers to the "CustomerID" in the "Customers" table. 
The relationship between the two tables above is the "CustomerID" column.

Then, we can create the following SQL statement (that contains an /INNER JOIN/), that selects records that have 
matching values in both tables:
    Example:
        SELECT Orders.OrderID, Customers.CustomerName, Orders.OrderDate
        FROM Orders
        INNER JOIN Customers ON Orders.CustomerID=Customers.CustomerID;


""" Different Types of SQL JOINs """
Here are the different types of the JOINs in SQL:

    * (INNER) JOIN: Returns records that have matching values in both tables
    * LEFT (OUTER) JOIN: Returns all records from the left table, and the matched records from the right table
    * RIGHT (OUTER) JOIN: Returns all records from the right table, and the matched records from the left table
    * FULL (OUTER) JOIN: Returns all records when there is a match in either left or right table


""" SQL AVG() Function """
The /AVG()/ function returns the average value of a numeric column.

    Example - Find the average price of all products:
        SELECT AVG(Price)
        FROM Products;

Note: NULL values are ignored.


""" Syntax """
SELECT AVG(column_name)
FROM table_name
WHERE condition;


""" Add a WHERE Clause """
You can add a /WHERE/ clause to specify conditions:
    Example - Returns the average price of products in category 1:
        SELECT AVG(Price)
        FROM Products
        WHERE CategoryID = 1;


""" Use an Alias """
Give the AVG column a name by using the /AS/ keyword.
    Example - Name the column "average price":
        SELECT AVG(Price) AS [average price]
        FROM Products;


""" Higher Than Average """
To list all records with a higher price than average, we can use the /AVG()/ function in a sub query:
    Example - Return all products with a higher price than the average price:
        SELECT * FROM Products
        WHERE Price > (SELECT AVG(price) FROM Products);


""" Use AVG() with GROUP BY """
Here we use the /AVG()/ function and the /GROUP BY/ clause, to return the average price for each category in 
the Products table:
    Example:
        SELECT AVG(Price) AS AveragePrice, CategoryID
        FROM Products
        GROUP BY CategoryID;